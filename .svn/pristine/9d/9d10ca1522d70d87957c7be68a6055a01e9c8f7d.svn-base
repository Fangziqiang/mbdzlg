package com.jadlsoft.json;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.HashMap;
import java.util.Map;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.jadlsoft.business.dzlg.DzlgManager;
import com.jadlsoft.utils.SpringBeanFactory;
@SuppressWarnings("unchecked")
public class DzlgGxgzJsonServlet extends HttpServlet {

	public void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		this.doPost(request, response);
	}

	public void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		DzlgManager dzlgManager = (DzlgManager) SpringBeanFactory
				.getBean("dzlgManager");
		// 读取请求内容
		response.setCharacterEncoding("GBK");
		PrintWriter out = response.getWriter();
		String sbbh = request.getParameter("sbbh");
		String jd = request.getParameter("jd");
		String wd = request.getParameter("wd");
		String dwdm = request.getParameter("dwdm");
		String htid = request.getParameter("htid");
		String xmbh = request.getParameter("xmbh");
		Map map = new HashMap();
		map.put("qbqbh", sbbh);
		map.put("jd", jd);
		map.put("wd", wd);
		map.put("dwdm", dwdm);
		map.put("htid", htid);
		map.put("xmbh", xmbh);
		map.put("dataType", "gxgz");
		String strXml = dzlgManager.createXml(map);
		out.print(dzlgManager.getJsonReturnValue(strXml,map));
	}
}
